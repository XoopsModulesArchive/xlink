<?php//  -------------------------------------------------------------------------- ////  [CONTENT RELATIONS MGR FOR XOOPS-R2]//  Author: Toms Veilands [tomsys@tomsys.net] [www.tomsys.net] [AKA tomsys]//  Credits: Xoops Team [www.xoops.org]//  Version: 1.0//  ReleaseDate: May 03, 2003//  License: GPL - [http://www.gnu.org/licenses/gpl.html]//  -------------------------------------------------------------------------- //function xlink_user_block_show() {//please adapt - bitte bearbeiten	global $xoopsDB, $xoopsUser, $xoopsModule, $xoopsConfig, $storytopic, $storyid, $articleid, $category, $forum, $cat, $album, $page, $cid, $lid, $_SERVER, $xoopsOption, $op, $rows, $link_old_title, $link_title, $link_id, $moduleid;//adaptation end - bearbeitung ende	  if(!empty($HTTP_POST_VARS['referer'])){    echo "<input type='hidden' name='referer' value='" . $HTTP_POST_VARS['referer'] . "' />\n";}elseif(!empty($HTTP_SERVER_VARS['HTTP_REFERER'])){    echo "<input type='hidden' name='referer' value='" . $HTTP_SERVER_VARS['HTTP_REFERER'] . "' />\n";}  	$isuser = !empty($xoopsUser) ? true : false;	if ($isuser) {		$isadmin = isset($xoopsUser) ? intval($xoopsUser->isAdmin()) : 0;	}	$moduleid = isset($xoopsModule) ? intval($xoopsModule->mid()) : '';	if (isset($xoopsModule)){		        $sql  = "";		        $sql  = !empty($moduleid) ? "SELECT a.urid, a.modid, b.title, b.url, a.visible FROM ".$xoopsDB->prefix('xlink')." a, ".$xoopsDB->prefix('xlink_uri')." b WHERE a.modid = $moduleid AND a.urid = b.urid " : "";//please adapt - bitte bearbeiten		        $sql .= !empty($cid) ? "AND a.downloadcatid = $cid " : "AND a.downloadcatid = 0 ";		        $sql .= !empty($storytopic) ? "AND a.topicid = $storytopic " : "AND a.topicid = 0 ";		        $sql .= !empty($storyid) ? "AND a.storyid = $storyid " : "AND a.storyid = 0 ";										$sql .= !empty($articleid) ? "AND a.articleid = $articleid " : "AND a.articleid = 0 ";										$sql .= !empty($category) ? "AND a.category = $category " : "AND a.category = 0 ";										$sql .= !empty($forum) ? "AND a.forum = $forum " : "AND a.forum = 0 ";										$sql .= !empty($cat) ? "AND a.cat = $cat " : "AND a.cat = 0 ";										$sql .= !empty($album) ? "AND a.album = $album " : "AND a.album = 0 ";          $sql .= empty($isadmin) ? "AND a.visible = 0 " : "";//adaptation end - bearbeitung ende												        $sql .= " ORDER BY 'url' ASC";		      $result = $xoopsDB->queryF($sql);		 $retStrAdmin = "";		  $retStrUser = "";		while ($myrow = $xoopsDB->fetchArray($result)) {		$retStrAdmin .= ""					 ."<a href='".XOOPS_URL."/modules/xlink/dropsinglebookmark.php?link_id=".$myrow['urid']."' title='"._MB_XLINK_WARNDELLINK."'><img hspace='2' align='absmiddle' src='".XOOPS_URL."/modules/xlink/images/remove.gif' border='0' /></a>";					 if ($myrow['visible'] == 0) {						$retStrAdmin .= "<a href='".XOOPS_URL."/modules/xlink/hideuserblocklink.php?link_id=".$myrow['urid']."' title='"._MB_XLINK_HIDETHISLINK."'><img hspace='2' align='absmiddle' src='".XOOPS_URL."/modules/xlink/images/hide.gif' border='0' /></a>";					 } else {						$retStrAdmin .= "<a href='".XOOPS_URL."/modules/xlink/unhideuserblocklink.php?link_id=".$myrow['urid']."' title='"._MB_XLINK_UNHIDETHISLINK."'><img hspace='2' align='absmiddle' src='".XOOPS_URL."/modules/xlink/images/unhide.gif' border='0' /></a>";					 }		 $retStrUser .= "<a href='".$myrow['url']."'>".$myrow['title']."</a><br />";			 $retStrAdmin  .= "<a href='".$myrow['url']."'>".$myrow['title']."</a><br />";		}				}	$block = array();	if (!empty($retStrAdmin)) {		$block['UserAdminBlock'] =  "".$retStrAdmin;		$block['UserBlock'] = "".$retStrUser;	}	return $block;}?>